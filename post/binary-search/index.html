<!doctype html><!-- This site was created with Wowchemy. https://www.wowchemy.com --><!-- Last Published: February 4, 2024 --><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.7.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><link rel=stylesheet href=/css/vendor-bundle.min.047268c6dd09ad74ba54a0ba71837064.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css integrity="sha512-KlJCpRsLf+KKu2VQa5vmRuClRFjxc5lXO03ixZt82HZUk41+1I0bD8KBSA0fY290ayMfWYI9udIqeOWSu1/uZg==" crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=/css/wowchemy.d1074f8af93a3c818e7ddf864bccad0a.css><link rel=stylesheet href=/css/libs/chroma/github-light.min.css title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=/css/libs/chroma/dracula.min.css title=hl-dark media=print onload='this.media="all"' disabled><meta name=author content="Manuel Pagliuca"><meta name=description content="Everything to know about Binary Search"><link rel=alternate hreflang=en-us href=https://manuelpagliuca.github.io/post/binary-search/><link rel=canonical href=https://manuelpagliuca.github.io/post/binary-search/><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu4a5b1b591c5ae08b60d2e1d27385e465_426_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu4a5b1b591c5ae08b60d2e1d27385e465_426_180x180_fill_lanczos_center_3.png><meta name=theme-color content="#1565c0"><meta property="twitter:card" content="summary"><meta property="twitter:site" content="@pagliucamanuel"><meta property="twitter:creator" content="@pagliucamanuel"><meta property="twitter:image" content="https://manuelpagliuca.github.io/media/icon_hu4a5b1b591c5ae08b60d2e1d27385e465_426_512x512_fill_lanczos_center_3.png"><meta property="og:site_name" content="Manuel Pagliuca"><meta property="og:url" content="https://manuelpagliuca.github.io/post/binary-search/"><meta property="og:title" content="Binary Search | Manuel Pagliuca"><meta property="og:description" content="Everything to know about Binary Search"><meta property="og:image" content="https://manuelpagliuca.github.io/media/icon_hu4a5b1b591c5ae08b60d2e1d27385e465_426_512x512_fill_lanczos_center_3.png"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2024-02-03T10:02:31+01:00"><meta property="article:modified_time" content="2024-02-03T10:02:31+01:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://manuelpagliuca.github.io/post/binary-search/"},"headline":"Binary Search","datePublished":"2024-02-03T10:02:31+01:00","dateModified":"2024-02-03T10:02:31+01:00","author":{"@type":"Person","name":"Manuel Pagliuca"},"publisher":{"@type":"Organization","name":"Manuel Pagliuca","logo":{"@type":"ImageObject","url":"https://manuelpagliuca.github.io/media/icon_hu4a5b1b591c5ae08b60d2e1d27385e465_426_192x192_fill_lanczos_center_3.png"}},"description":"Everything to know about Binary Search"}</script><title>Binary Search | Manuel Pagliuca</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=9af09b54f422c3f5f92fef55079928b5><script src=/js/wowchemy-init.min.e30f5b1eda0d3e8f556d60890f98926f.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class="page-header header--fixed"><header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Manuel Pagliuca</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Manuel Pagliuca</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#about><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/#projects><span>Projects</span></a></li><li class=nav-item><a class=nav-link href=/#posts><span>Posts</span></a></li><li class=nav-item><a class=nav-link href=/#contact><span>Contact</span></a></li><li class=nav-item><a class=nav-link href=/uploads/CV_SWE.pdf><span>Resume</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class="nav-item d-none d-lg-inline-flex"><a class=nav-link href=https://twitter.com/pagliucamanuel data-toggle=tooltip data-placement=bottom title="Follow me on Twitter" target=_blank rel=noopener aria-label="Follow me on Twitter"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li><li class="nav-item dropdown theme-dropdown"><a href=# class=nav-link data-toggle=dropdown aria-haspopup=true aria-label="Display preferences"><i class="fas fa-moon" aria-hidden=true></i></a><div class=dropdown-menu><a href=# class="dropdown-item js-set-theme-light"><span>Light</span></a>
<a href=# class="dropdown-item js-set-theme-dark"><span>Dark</span></a>
<a href=# class="dropdown-item js-set-theme-auto"><span>Automatic</span></a></div></li></ul></div></nav></header></div><div class=page-body><article class=article><div class="article-container pt-3"><h1>Binary Search</h1><div class=article-metadata><span class=article-date>Feb 3, 2024</span>
<span class=middot-divider></span>
<span class=article-reading-time>10 min read</span></div></div><div class=article-container><div class=article-style><h2 id=basic-binary-search>Basic binary search</h2><p>The <a href=https://en.wikipedia.org/wiki/Binary_search_algorithm target=_blank rel=noopener>binary search</a> it&rsquo;s a <strong>search algorithm</strong> which find the index of a particular value which is stored in a <strong>sorted</strong> array.</p><ul><li><a href=https://en.wikipedia.org/wiki/Random_access target=_blank rel=noopener>Random access</a> is a requirement for performing this search.</li></ul><p>The binary search classical formalization is the following:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>binary_search</span><span class=p>(</span><span class=n>nums</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>],</span> <span class=n>target</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>start</span><span class=p>,</span> <span class=n>end</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>nums</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>start</span> <span class=o>&lt;=</span> <span class=n>end</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mid</span> <span class=o>=</span> <span class=n>start</span> <span class=o>+</span> <span class=p>(</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>nums</span><span class=p>[</span><span class=n>mid</span><span class=p>]</span> <span class=o>==</span> <span class=n>target</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>mid</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>nums</span><span class=p>[</span><span class=n>mid</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>target</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>start</span> <span class=o>=</span> <span class=n>mid</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>end</span> <span class=o>=</span> <span class=n>mid</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>-</span><span class=mi>1</span>
</span></span></code></pre></div><p>It is the most intuitive way of understanding the behaviour of this algorithm, let&rsquo;s walk through the iterations.</p><h3 id=first-loop>First loop</h3><p>Initial variables:</p><ul><li><code>nums = [1, 3, 4, 5, 6, 8, 9, 10, 11, 12]</code></li><li><code>target = 5</code></li><li><code>start = 0, end = 9</code>
Algorithm steps:</li></ul><ol><li>The mid index get computed as <code>mid = 0 + 9 / 2 = 4</code>, this is a bad case, because the <code>target</code> is one position away from the <code>mid</code>.<figure><div class="d-flex justify-content-center"><div class=w-100><img src=./bs-00.drawio.png alt=bs-0 loading=lazy data-zoomable></div></div></figure></li><li>Test <code>target</code> against mid value:<ol><li>Is <code>target</code> equal to mid value? No (<code>5 != 6</code>)</li><li>Is <code>target</code> smaller than mid value? Yes (<code>5 &lt; 6</code>), let&rsquo;s continue the search on the left side of the mid element (<code>end = mid - 1</code>).</li></ol></li></ol><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=./bs-01.drawio.png alt=bs-1 loading=lazy data-zoomable></div></div></figure></p><h3 id=second-loop>Second loop</h3><ol><li>The mid index get computed as <code>mid = 0 + 3 / 2 = 1</code><figure><div class="d-flex justify-content-center"><div class=w-100><img src=./bs-02.drawio.png alt=bs-2 loading=lazy data-zoomable></div></div></figure></li><li>Test <code>target</code> against mid value:<ol><li>Is <code>target</code> equal to mid value? No (<code>5 != 3</code>)</li><li>Is <code>target</code> smaller than mid value? No (<code>5 > 3</code>)</li><li>Is <code>target</code> bigger than mid value? Yes, let&rsquo;s continue the search on the right side of the mid element (<code>start = mid + 1</code>).</li></ol></li></ol><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=./bs-03.drawio.png alt=bs-3 loading=lazy data-zoomable></div></div></figure></p><h3 id=third-loop>Third loop</h3><ol><li>The mid index get computed as <code>mid = 2 + 3 / 2 = 2</code><figure><div class="d-flex justify-content-center"><div class=w-100><img src=./bs-04.drawio.png alt=bs-4 loading=lazy data-zoomable></div></div></figure></li><li>Test <code>target</code> against mid value:<ol><li>Is <code>target</code> equal to mid value? No (<code>5 != 4</code>)</li><li>Is <code>target</code> smaller than mid value? No (<code>5 > 4</code>)</li><li>Is <code>target</code> bigger than mid value? Yes, let&rsquo;s continue the search on the right side of the mid element (<code>start = mid + 1</code>).</li></ol></li></ol><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=./bs-05.drawio.png alt=bs-5 loading=lazy data-zoomable></div></div></figure></p><h3 id=fourth-loop>Fourth loop</h3><ol><li>The mid index get computed as <code>mid = 3 + 3 / 2 = 3</code><figure><div class="d-flex justify-content-center"><div class=w-100><img src=./bs-06.drawio.png alt=bs-6 loading=lazy data-zoomable></div></div></figure></li><li>Test <code>target</code> against mid value:<ol><li>Is <code>target</code> equal to mid value? Yes (<code>5 == 5</code>), the <code>mid</code> index is returned.</li></ol></li></ol><p>Although the conceptual idea of binary search is comparatively straightforward, the details can be tricky.</p><p>The real pit of binary search is not the integer overflow, but the whether to add one to or subtract one from <code>mid</code>, and where to use <code>&lt;=</code> or <code>&lt;</code> in the loop condition.</p><h2 id=generalized-framework>Generalized framework</h2><p><strong>Minimizing k which satisfies the <code>condition(k)</code> function.</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>binary_search</span><span class=p>(</span><span class=n>array</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>condition</span><span class=p>(</span><span class=n>value</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>start</span><span class=p>,</span> <span class=n>end</span> <span class=o>=</span> <span class=nb>min</span><span class=p>(</span><span class=n>search_space</span><span class=p>),</span> <span class=nb>max</span><span class=p>(</span><span class=n>search_space</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>start</span> <span class=o>&lt;</span> <span class=n>end</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mid</span> <span class=o>=</span> <span class=n>start</span> <span class=o>+</span> <span class=p>(</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>condition</span><span class=p>(</span><span class=n>mid</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>end</span> <span class=o>=</span> <span class=n>mid</span>       <span class=c1># Inclusive reduction of the right boundary</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>start</span> <span class=o>=</span> <span class=n>mid</span> <span class=o>+</span> <span class=mi>1</span> <span class=c1># Exclusive reduction of the left boundary</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>start</span>
</span></span></code></pre></div><p><strong>After exiting the loop, <code>start</code> is the minimal k satisfying the inner <code>condition</code> function.</strong></p><p>We should care about three parts of this template:</p><ul><li>Initialisation of the boundary variables <code>start</code> and <code>end</code> to specify the <strong>search space</strong> (all the possible elements).</li><li>Decide return value.</li><li>Design the <code>condition</code> function, this is the hardest part.</li></ul><p>Let&rsquo;s see the basic search with the generalized framework:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>binary_search</span><span class=p>(</span><span class=n>nums</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>],</span> <span class=n>target</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>start</span><span class=p>,</span> <span class=n>end</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>nums</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>start</span> <span class=o>&lt;</span> <span class=n>end</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mid</span> <span class=o>=</span> <span class=n>start</span> <span class=o>+</span> <span class=p>(</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>nums</span><span class=p>[</span><span class=n>mid</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=n>target</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>end</span> <span class=o>=</span> <span class=n>mid</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>start</span> <span class=o>=</span> <span class=n>mid</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>start</span>
</span></span></code></pre></div><p>This looks a bit less readable than the classical algorithm, but understanding the mechanics behind this will allow to gneeralize the binar search to many more coding problems.</p><p><em>Why are we using <code>>=</code> in the <strong>condition function</strong>?</em></p><p>Think in this way, we are <strong>searching for the minimum k for which <code>nums[mid] >= target</code></strong>, we are searching the value (index) that satisfies the condition. If we would use <code>></code> instead of <code>>=</code> we would get the index k which is greater (and not equal) than <code>target</code>.</p><p>Considering the following example with just two elements of an array, if we apply the <strong>condition function</strong> with <code>></code>, it would trigger the expression in the <code>else</code> branch, which will set <code>start</code> to <code>mid + 1</code>.</p><img src=./only-greater-0.drawio.png alt=image width=20% height=auto><p>This would stop the loop (<code>start == end</code>), but now <code>start</code> (<strong>k</strong>) is the index of an element greater than <code>target</code>.</p><img src=./only-greater-1.drawio.png alt=image width=20% height=auto><p><em>What return condition should I use if the element is not in the list?</em></p><p>That&rsquo;s a nice question, and it should be specified from the problem itself, the previous code was assuming that the element was always present. If the <code>target</code> can miss, a common requirement is to return <code>-1</code>, which can be easily written in the return condition:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>    <span class=k>return</span> <span class=n>start</span> <span class=k>if</span> <span class=n>nums</span><span class=p>[</span><span class=n>start</span><span class=p>]</span> <span class=o>==</span> <span class=n>target</span> <span class=k>else</span> <span class=o>-</span><span class=mi>1</span>
</span></span></code></pre></div><h3 id=1st-loop>1st loop</h3><p>Initial variables:</p><ul><li><code>nums = [1, 3, 4, 5, 6, 8, 9, 10, 11, 12]</code></li><li><code>target = 5</code></li><li><code>start = 0, end = 9</code></li></ul><p>Algorithm steps:</p><ol><li><code>mid = 4</code><figure><div class="d-flex justify-content-center"><div class=w-100><img src=./bs-framework-0.drawio.png alt=bs-fw-0 loading=lazy data-zoomable></div></div></figure></li><li>Test the <strong>condition function</strong> <code>nums[mid] >= target</code>:<ol><li>Is <code>nums[mid] >= target</code>? Yes (<code>6 > 5</code>), reduce the <strong>search space</strong> from the right (<code>mid</code> excluded).</li></ol></li></ol><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=./bs-framework-1.drawio.png alt=bs-fw-1 loading=lazy data-zoomable></div></div></figure></p><h3 id=2nd-loop>2nd loop</h3><ol><li><code>mid = 2</code><figure><div class="d-flex justify-content-center"><div class=w-100><img src=./bs-framework-2.drawio.png alt=bs-fw-2 loading=lazy data-zoomable></div></div></figure></li><li>Test the <strong>condition function</strong> <code>nums[mid] >= target</code>:<ol><li>Is <code>nums[mid] >= target</code>? No (<code>4 &lt; 5</code>)</li><li>Then <code>nums[mid] &lt; target</code>, reduce the <strong>search space</strong> from the left (<code>mid</code> included).<figure><div class="d-flex justify-content-center"><div class=w-100><img src=./bs-framework-3.drawio.png alt=bs-fw-3 loading=lazy data-zoomable></div></div></figure></li></ol></li></ol><h3 id=3rd-loop>3rd loop</h3><ol><li><code>mid = 3</code><figure><div class="d-flex justify-content-center"><div class=w-100><img src=./bs-framework-4.drawio.png alt=bs-fw-4 loading=lazy data-zoomable></div></div></figure></li><li>Test the <strong>condition function</strong> <code>nums[mid] >= target</code>:<ol><li>Is <code>nums[mid] >= target</code>? Yes (<code>5 == 5</code>), reduce the <strong>search space</strong> from the right (<code>mid</code> excluded).<figure><div class="d-flex justify-content-center"><div class=w-100><img src=./bs-framework-5.drawio.png alt=bs-fw-5 loading=lazy data-zoomable></div></div></figure></li></ol></li></ol><p>The next loop condition check will be evaluated as <code>False</code> since <code>start == end == 3</code></p><h2 id=application-of-the-generalized-framework>Application of the generalized framework</h2><h3 id=sqrttarget><code>sqrt(target)</code></h3><p>Searching for the minimal k satisfying <code>k^2 > target</code> condition, then the answer is <code>k - 1</code>.</p><ul><li>The loop will terminate with <code>start == end</code>, in the last iteration if <strong>inner condition function</strong>
is satisfied, the <code>start</code> variable will contain <strong>the minimal <code>k</code> for which <code>mid * mid > target</code></strong>, this means that the answer is <code>start - 1</code></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>my_sqrt</span><span class=p>(</span><span class=n>x</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>start</span><span class=p>,</span> <span class=n>end</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>x</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>start</span> <span class=o>&lt;</span> <span class=n>end</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mid</span> <span class=o>=</span> <span class=n>start</span> <span class=o>+</span> <span class=p>(</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>mid</span> <span class=o>*</span> <span class=n>mid</span> <span class=o>&gt;</span> <span class=n>x</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>end</span> <span class=o>=</span> <span class=n>mid</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>start</span> <span class=o>=</span> <span class=n>mid</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>start</span> <span class=o>-</span> <span class=mi>1</span>
</span></span></code></pre></div><p>It is also possible to use as return value the <code>mid</code> index if declared outside the loop cycle, the code will behave in the same way for perfect squares, while it will approximate by <em>excess</em> non-square inputs (the code will approximate by <em>default</em>).</p><h3 id=search-insert-position>Search Insert Position</h3><p><strong>TODO: THIS ARTICLE HAS TO BE COMPLETED, AT THE MOMENT IS JUST A BUNCH OF NOTES</strong></p><p>Searching for the <strong>minimal k value satisfying <code>nums[k] >= target</code></strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>search_insert</span><span class=p>(</span><span class=n>nums</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>],</span> <span class=n>target</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>start</span><span class=p>,</span> <span class=n>end</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>nums</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>start</span> <span class=o>&lt;</span> <span class=n>end</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>mid</span> <span class=o>=</span> <span class=n>start</span> <span class=o>+</span> <span class=p>(</span><span class=n>end</span> <span class=o>-</span> <span class=n>start</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>nums</span><span class=p>[</span><span class=n>mid</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=n>target</span><span class=p>:</span>
</span></span></code></pre></div><h3 id=why--instead-of--in-the-loop-condition>Why <code>&lt;=</code> instead of <code>&lt;</code> in the loop condition?</h3><p>Because the initial assignment of <code>end</code> is <code>len(nums) - 1</code>, which is the index of the last element, and not <code>len(nums)</code> (which contains an extra <em>immaginary</em> element).</p><ul><li>The first approach has a <strong>search space</strong> of <code>[start, end]</code></li><li>The second approach has a <strong>search space</strong> of <code>[start, end)</code></li></ul><p>The binary search can terminate when the value is found <code>nums[mid] == target</code>, but if not found <strong>it should terminate when the search interval is empty</strong>, which means that if you don&rsquo;t have a place for searching it, you haven&rsquo;t found it.</p><p>Termination conditions:</p><ul><li>For <code>start &lt;= end</code> is <code>start == end + 1</code>, when the <code>start</code> index surpass by 1 element the <code>end</code> index.</li><li>For <code>start &lt; end</code> is <code>start == end</code>, when they are both on the same element.</li></ul><h3 id=why-left--mid--1-and-right--mid---1>Why <code>left = mid + 1</code> and <code>right = mid - 1</code>?</h3><h3 id=flaws-of-the-basic-algorithm>Flaws of the basic algorithm</h3><p>This algorithm is great and simple, but has some limitations. In some specific problems, some target number could be repeated along the array, and the problem requiremnt could be the left border or right border of this sequence.</p><p><strong>The current algorithm can&rsquo;t handle this issue.</strong></p><ul><li>Adding a <strong>linear search</strong> to the found sequence will compromise the complexity in time of the binary search.</li></ul><h2 id=binary-search-101>Binary Search 101</h2><p>When it comes to implementation, it&rsquo;s rather difficult to write a bug-free code in just a few minutes.</p><ul><li>Should I use <code>start &lt; end</code> or <code>start &lt;= end</code> as loop condition?</li><li>How to initialize the boundary variable <code>start</code> and <code>end</code>?</li><li>How to update the boundary? <code>left = mid</code> or <code>left = mid + 1</code>, &mldr;</li><li>When to exit the loop?</li></ul><p>This because in real-life problems and coding questions, it&rsquo;s really hard that a classical implementation of the algorithm will be required.</p><h3 id=search-space-boundary>Search space boundary</h3><p>Normally we can see this kind of boundary initialization:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>    <span class=n>start</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>end</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>nums</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span>
</span></span></code></pre></div><p>But this is not always the case.</p><blockquote><p>The boundary is the range of elements we will be searching from. The initial boudnary should include all the elmeents, meaning all the possible answers should be included.</p></blockquote><p>For example, in <a href=https://leetcode.com/problems/search-insert-position/description/ target=_blank rel=noopener>LeetCode #35</a> if the <code>target</code> isn&rsquo;t found we have to return the the index of where the element could be, and this could be even after the last element.</p><p>This means that the search space will be bigger:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>    <span class=n>start</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>end</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>nums</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=calculating-mid>Calculating <code>mid</code></h3><p>When the number are extremely big it can result in an <a href=https://en.wikipedia.org/wiki/Integer_overflow target=_blank rel=noopener><strong>integer overflow</strong></a>.</p><p>There are three ways of computing the <code>mid</code> index, from the worst to the best.</p><h4 id=first-approach>First approach</h4><blockquote><p><code>mid = (start + end) / 2</code></p></blockquote><p>This is the most readable approach, but the risk of incurring in <strong>integer overflow</strong> (going beyond the representation limits for integers) is high with bigger values of <code>start</code> and <code>end</code>.</p><h3 id=second-approach>Second approach</h3><blockquote><p><code>mid = start + (end - start) // 2</code></p></blockquote><p>This approach is a refinement of the first, subtracting <code>start</code> from <code>end</code> reduces the amount of numbers involved in the sum.</p><h3 id=third-approach>Third approach</h3><blockquote><p><code>mid = (start + end) >> 1</code></p></blockquote><p>The <strong>right shift</strong> bitwise operator doesn&rsquo;t introduce new bits in the representation of a number, this means that can&rsquo;t cause an overflow on big numbers.</p><h3 id=left-and-right-mid>Left and right mid</h3><p>When we are dealing with an <strong>even</strong> number of elements, it is our choice to pick the <strong>left mid</strong> or the <strong>right mid</strong></p><p>Left mid (<strong>integer division</strong> prefer the left side of the array):</p><blockquote><p><code>mid = start + (end - start) // 2</code></p></blockquote><p>Right mid:</p><blockquote><p><code>mid = start + (end - start + 1) // 2</code></p></blockquote><h2 id=boundary-shrinking-strategy>Boundary shrinking strategy</h2><p>The best strategy to adopt is to always use a logic that <strong>excludes</strong> <code>mid</code> from the <strong>search space</strong>.</p><p>If the target is less than <code>mid</code>, it can&rsquo;t be <code>mid</code>, so we can exclude it <code>end = mid - 1</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python></code></pre></div><p>si ma perchè?..</p><h3 id=symmetric-variant>Symmetric variant</h3><h2 id=loop-condition>Loop condition</h2><p>Using only <code>&lt;</code> the <strong>only condition</strong> the loop exits is <code>start == end</code>, this means that they are pointing to only one element.</p><blockquote><p><code>while (start &lt; high):</code></p></blockquote><h2 id=infinity-loop>Infinity loop</h2><p>A bad choice of <a href=#left-and-right-mid>left and right mid</a> will lead to <strong>infinity loop</strong>.</p><p><strong>The choice of <code>mid</code> and our shrinking logic has to work together in a way that every time, at least 1 element is excluded.</strong></p><p>Let&rsquo;s consider the base case when we have only two elements (which is like having <em>even</em> number of elements in the input), and how
two misplaced mid will lead to infinite loop.</p><h3 id=wrong-left-mid>Wrong left mid</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>if</span> <span class=n>target</span> <span class=o>&lt;</span> <span class=n>nums</span><span class=p>[</span><span class=n>mid</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=n>start</span> <span class=o>=</span> <span class=n>mid</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=n>end</span> <span class=o>=</span> <span class=n>mid</span>
</span></span></code></pre></div><p>Using this logic with the <strong>left mid</strong>, in the case the execution will reach the <code>else</code> (this means that the <code>target</code> isn&rsquo;t the element pointed from <code>mid</code>), it will just keep &ldquo;update&rdquo; the <code>mid</code> element to the same value of <code>start</code>, and this will stuck the program for ever.</p><p>In this case we had to use the <strong>right mid</strong> instead <code>mid = start + (end - start + 1) // 2</code></p><img src=./bs-2-elements.drawio.png alt=image width=20% height=auto>
<img src=./bs-2-elements-mid.drawio.png alt=image width=20% height=auto><h3 id=wrong-right-mid>Wrong right mid</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>if</span> <span class=n>target</span> <span class=o>&gt;</span> <span class=n>nums</span><span class=p>[</span><span class=n>mid</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=n>end</span> <span class=o>=</span> <span class=n>mid</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=n>start</span> <span class=o>=</span> <span class=n>mid</span>
</span></span></code></pre></div><p>The same happens simmetrically with the <strong>right mid</strong>, the fix will be using the <strong>left mid</strong> <code>mid = start + (end - start) // 2</code></p><img src=./bs-2-elements-2.drawio.png alt=image width=20% height=auto>
<img src=./bs-2-elems-2-mid.drawio.png alt=image width=20% height=auto><h2 id=complexity>Complexity</h2><h2 id=resources>Resources</h2><p>These notes are heavily based on an article I found on Leetcode, rewriting and drawing the diagrams was a way for understanding the concepts better.</p><ul><li><a href=https://leetcode.com/problems/binary-search/solutions/423162/Binary-Search-101-The-Ultimate-Binary-Search-Handbook/ target=_blank rel=noopener>Binary Search 101</a> - AminiCK</li><li><a href=https://en.wikipedia.org/wiki/Binary_search_algorithm target=_blank rel=noopener>Wikipedia</a></li><li><a href=https://leetcode.com/discuss/general-discussion/786126/Python-Powerful-Ultimate-Binary-Search-Template.-Solved-many-problems target=_blank rel=noopener>[Python] Powerful Ultimate Binary Search Template. Solved many problems</a> - zhijun_liao</li><li><a href="https://www.youtube.com/watch?v=GU7DpgHINWQ" target=_blank rel=noopener>Binary Search tutorial (C++ and Python)</a> - Errichto</li></ul></div><div class=article-tags><a class="badge badge-light" href=/tag/algorithms/>Algorithms</a>
<a class="badge badge-light" href=/tag/data-structures/>Data Structures</a>
<a class="badge badge-light" href=/tag/coding/>Coding</a></div><div class=share-box><ul class=share><li><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fmanuelpagliuca.github.io%2Fpost%2Fbinary-search%2F&amp;text=Binary+Search" target=_blank rel=noopener class=share-btn-twitter aria-label=twitter><i class="fab fa-twitter"></i></a></li><li><a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fmanuelpagliuca.github.io%2Fpost%2Fbinary-search%2F&amp;t=Binary+Search" target=_blank rel=noopener class=share-btn-facebook aria-label=facebook><i class="fab fa-facebook"></i></a></li><li><a href="mailto:?subject=Binary%20Search&amp;body=https%3A%2F%2Fmanuelpagliuca.github.io%2Fpost%2Fbinary-search%2F" target=_blank rel=noopener class=share-btn-email aria-label=envelope><i class="fas fa-envelope"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fmanuelpagliuca.github.io%2Fpost%2Fbinary-search%2F&amp;title=Binary+Search" target=_blank rel=noopener class=share-btn-linkedin aria-label=linkedin-in><i class="fab fa-linkedin-in"></i></a></li><li><a href="whatsapp://send?text=Binary+Search%20https%3A%2F%2Fmanuelpagliuca.github.io%2Fpost%2Fbinary-search%2F" target=_blank rel=noopener class=share-btn-whatsapp aria-label=whatsapp><i class="fab fa-whatsapp"></i></a></li><li><a href="https://service.weibo.com/share/share.php?url=https%3A%2F%2Fmanuelpagliuca.github.io%2Fpost%2Fbinary-search%2F&amp;title=Binary+Search" target=_blank rel=noopener class=share-btn-weibo aria-label=weibo><i class="fab fa-weibo"></i></a></li></ul></div><div class="media author-card content-widget-hr"><a href=https://manuelpagliuca.github.io/><img class="avatar mr-3 avatar-circle" src=/authors/admin/avatar_hu67460b9bf0bfd29f1535b347c78b075f_147322_270x270_fill_q75_lanczos_center.jpg alt="Manuel Pagliuca"></a><div class=media-body><h5 class=card-title><a href=https://manuelpagliuca.github.io/>Manuel Pagliuca</a></h5><h6 class=card-subtitle>M.Sc. in Computer Science</h6><p class=card-text>My studies include Real-Time Graphics, GP-GPU, Artificial Intelligence and Distributed Systems.</p><ul class=network-icon aria-hidden=true><li><a href=/#contact><i class="fas fa-envelope"></i></a></li><li><a href=https://twitter.com/pagliucamanuel target=_blank rel=noopener><i class="fab fa-twitter"></i></a></li><li><a href=https://github.com/manuelpagliuca target=_blank rel=noopener><i class="fab fa-github"></i></a></li><li><a href=https://www.linkedin.com/in/manuel-pagliuca/ target=_blank rel=noopener><i class="fab fa-linkedin"></i></a></li><li><a href=/uploads/CV_SWE.pdf><i class="ai ai-cv"></i></a></li></ul></div></div></div></article></div><div class=page-footer><div class=container><footer class=site-footer><p class="powered-by copyright-license-text">© 2024 Manuel Pagliuca. This work is licensed under <a href=https://creativecommons.org/licenses/by-nc-nd/4.0 rel="noopener noreferrer" target=_blank>CC BY NC ND 4.0</a></p><p class="powered-by footer-license-icons"><a href=https://creativecommons.org/licenses/by-nc-nd/4.0 rel="noopener noreferrer" target=_blank aria-label="Creative Commons"><i class="fab fa-creative-commons fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-by fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-nc fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-nd fa-2x" aria-hidden=true></i></a></p><p class=powered-by>Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target=_blank rel=noopener>Wowchemy</a> — the free, <a href=https://github.com/wowchemy/wowchemy-hugo-themes target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></div><script src=/js/vendor-bundle.min.f64289d8217e08e3afcd597d60836062.js></script>
<script id=search-hit-fuse-template type=text/x-template>
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script><script src=https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin=anonymous></script>
<script id=page-data type=application/json>{"use_headroom":true}</script><script src=/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js type=module></script>
<script src=/en/js/wowchemy.min.3322c0d94f0e691b0b24c63f4c41064b.js></script><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> Download</a><div id=modal-error></div></div></div></div></div><script src=/js/wowchemy-publication.68f8d7090562ca65fc6d3cb3f8f2d2cb.js type=module></script></body></html>